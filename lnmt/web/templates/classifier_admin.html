<!DOCTYPE html>
<html><head><title>Classifier Config</title></head><body>
<h1>Classifier & Threshold Admin</h1>

<h2>DNS Whitelist</h2>
<ul>
{% for host in whitelist %}
<li>{{ host }} <form method="post" style="display:inline;"><input type="hidden" name="remove_whitelist" value="{{ host }}"><input type="submit" value="Remove"></form></li>
{% endfor %}
</ul>
<form method="post">
  Add: <input name="add_whitelist"><input type="submit" value="Add">
</form>

<h2>App Pattern Rules</h2>
<table><tr><th>App</th><th>Pattern</th><th>Action</th></tr>
{% for app, pattern in app_patterns %}
<tr><td>{{ app }}</td><td>{{ pattern }}</td>
<td><form method="post"><input type="hidden" name="remove_pattern" value="{{ pattern }}"><input type="submit" value="Remove"></form></td></tr>
{% endfor %}
</table>
<form method="post">
  App: <input name="app"> Pattern: <input name="pattern"><input type="submit" value="Add">
</form>

<h2>Thresholds</h2>
<table><tr><th>VLAN</th><th>Kbps</th><th>Window</th><th>Limit</th></tr>
{% for vlan, kbps, win, lim in thresholds %}
<tr><td>{{ vlan }}</td><td>{{ kbps }}</td><td>{{ win }}</td><td>{{ lim }}</td></tr>
{% endfor %}
</table>
<form method="post">
  VLAN: <input name="vlan"> Kbps: <input name="kbps"> Window: <input name="window"> Limit: <input name="limit">
  <input type="submit" value="Set/Update">
</form>

</body></html>
