<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Host - inetctl</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css" />
    <style>
        .delete-form {
            margin-top: 2rem;
        }

        .grid-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        nav {
            display: flex;
            align-items: center;
        }
    </style>
</head>
<body>
    <main class="container">
        <header>
            <nav>
                <ul><li><a href="{{ url_for('home') }}" class="secondary">← Back to Dashboard</a></li></ul>
            </nav>
            <h1>Edit Host</h1>
            <p>Editing configuration for <strong>{{ host.description | e }}</strong> (<code>{{ host.mac }}</code>)</p>
        </header>

        <article>
            <form action="{{ url_for('edit_host', host_mac=host.mac) }}" method="post">

                <label for="description">Description</label>
                <input type="text" id="description" name="description" value="{{ host.description }}" required>

                <label for="hostname">Hostname</label>
                <input type="text" id="hostname" name="hostname" value="{{ host.hostname }}" required>

                <label for="vlan_id">Assigned Network (VLAN)</label>
                <select id="vlan_id" name="vlan_id">
                    {% for network in networks %}
                    <!--
                    THIS IS THE LINE THAT HAS BEEN MANUALLY VERIFIED.
                    The comparison is now '=='
                    -->
                    <option value="{{ network.id }}" {% if host.vlan_id= =network.id %}selected{% endif %}>
                        {{ network.name }}
                    </option>
                    {% endfor %}
                </select>

                <label for="ip_assignment.ip">Static IP Address (optional)</label>
                <input type="text" id="ip_assignment.ip" name="ip_assignment.ip" value="{{ host.ip_assignment.ip if host.ip_assignment.type == 'static' else '' }}" placeholder="Leave blank for DHCP">

                <label for="network_access_blocked">
                    <input type="checkbox" id="network_access_blocked" name="network_access_blocked" role="switch" {% if host.network_access_blocked %}checked{% endif %}>
                    Network Access Blocked
                </label>

                <footer class="grid-buttons">
                    <button type="submit">Save Changes</button>
                    <a href="{{ url_for('home') }}" role="button" class="secondary">Cancel</a>
                </footer>
            </form>

            <hr>

            <form class="delete-form" action="{{ url_for('delete_host', host_mac=host.mac) }}" method="post" onsubmit="return confirm('WARNING: This will permanently delete this host from your configuration. This cannot be undone. Are you absolutely sure?');">
                <button type="submit" class="contrast outline">Delete This Host</button>
            </form>

        </article>
    </main>
</body>
</html>